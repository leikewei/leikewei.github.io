(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{603:function(e,t,i){"use strict";i.r(t);var s=i(604),a=i.n(s);for(var o in s)"default"!==o&&function(e){i.d(t,e,(function(){return s[e]}))}(o);t.default=a.a},604:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s,a=i(48),o=i(577);function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var r=(n(s={data:function(){return{supportType:0,pdfSrc:"",imgSrc:"",previewUrl:"",showUploadDialog:this.value,step:0,previewErrorNum:0,uploadStatus:"",fileInfo:{},savingData:!1,formTitle:""}},props:{value:{type:Boolean,default:!1},data:{type:Object,default:function(){return{}}},wrapClass:{type:String,default:""},isWorks:!1,isAnalysis:!1},watch:{value:function(e){this.showUploadDialog=e},pdfSrc:function(e){e&&this.watchPdfStatus()}},mounted:function(){"miniscan"==this.$route.query.from&&(this.showUploadDialog=!0,this.formTitle="您现在可以直接上传附件简历","1"==this.$route.query.annexType&&(this.formTitle="您现在可以直接上传作品集附件")),this.$eventBus.$off("uploadFile"),this.$eventBus.$on("uploadFile",this.uploadFile)},computed:{classes:function(){var e=["upload-resume-dialog"];return this.wrapClass&&e.push(this.wrapClass),this.step&&e.push("upload-preview-dialog"),e.join(" ")},maxSize:function(){return this.isWorks?15:8}},methods:{dialogChange:function(e){this.$emit("input",e),e||this.resetContent()},confirmDialog:function(){},showContent:function(){},resetContent:function(){this.pdfSrc="",this.imgSrc="",this.previewUrl="",this.step=0,this.previewErrorNum=0,this.uploadStatus="",this.fileInfo={},this.savingData=!1},getFileType:function(e){if(!e)return"";var t=e.split(".").length;return e.split(".")[t-1]},uploadFile:function(){this.$refs.selectfile.click()},handleFileChange:function(e){var t=this,i=this.$refs.selectfile.files[0];if(i){this.sendEvent("resume-size-choose-fail",this.isWorks?2:1);var s=i.name.split("."),o=s[s.length-1].toLowerCase();if(["ppt","pptx","doc","docx","pdf","png","jpg","jpeg"].indexOf(o)<0)return this.$toast({type:"error",title:"提示",content:"选择的文件无效，请重新选择"}),this.sendEvent("user_resume_size_notsupport"),this.step=null,this.$nextTick((function(){t.step=0})),!1;if(i.size>1024*this.maxSize*1024)return this.$toast({type:"error",title:"提示",content:"上传文件超过".concat(this.maxSize,"M，请重新选择")}),this.sendEvent("user_resume_size_limit"),this.step=null,this.$nextTick((function(){t.step=0})),!1;this.sendEvent("resume-upload-web",this.isWorks?2:1);var n=new FormData;if(n.append("file",i),n.append("fileType",this.isWorks?2:1),this.isAnalysis){this.showUploadDialog=!1;(0,a.post)("/wapi/zpgeek/cvresume/attachment/parser/upload.json",n).then((function(e){0==e.code?(t.previewUrl=e.zpData.previewUrl,t.isWorks=!1,t.confimAdd()):(t.uploadStatus="uploadFail",t.$toast({type:"error",content:e.message}),t.sendEvent("resume-upload-fail",t.isWorks?2:1))})).catch((function(e){t.uploadStatus="uploadFail",t.$toast({type:"error",content:"上传失败，请重试"}),t.sendEvent("resume-upload-fail",t.isWorks?2:1)}))}this.$emit("sureFile",n);var r=this.isAnalysis?"/wapi/zpgeek/resume/attachment/parser/upload.json":"/wapi/zpgeek/cvresume/attachment/parser/upload.json";(0,a.post)(r,n).then((function(i){if(t.isAnalysis)t.dealUploadAndParser(i),e.target.value="";else if(0==i.code)t.previewUrl=i.zpData.previewUrl,t.uploadStatus="uploadSuccess",t.isWorks?t.checkFileType():t.previewImg();else{t.uploadStatus="uploadFail",t.$toast({type:"error",content:i.message}),t.isAnalysis?t.showUploadDialog=!1:t.sendEvent("resume-upload-fail",t.isWorks?2:1);try{t.sendEvent("user_resume_upload_error")}catch(e){}}})).catch((function(e){t.uploadStatus="uploadFail",t.$toast({type:"error",content:"上传失败，请重试"}),t.sendEvent("resume-upload-fail",t.isWorks?2:1)})),this.fileInfo=i,this.uploadStatus="uploadIng",this.isAnalysis||(this.step=1)}},dealUploadAndParser:function(e){switch(e.code){case 0:e.zpData.key&&""!=e.zpData.key.trim()?this.$emit("uploadResult",e):($.dialog({title:"",content:'<div style="padding: 4px 0 30px;">暂且无法解析，您可以选择其他文件或者尝试直接注册。</div>',type:"error",closeText:!0,confirmText:"确定",cancelText:!1,preKa:"",wrapClass:"dialog-icons-default",lock:!0}),"function"==typeof failCallback&&failCallback());break;case 24:$.dialog({title:"",content:'<div style="padding: 4px 0 30px;">请切换至牛人身份</div>',type:"error",closeText:!0,confirmText:"确定",cancelText:!1,preKa:"",wrapClass:"dialog-icons-default",lock:!0});break;case 200214:$.toast({content:"牛人身份已完善，即将为你跳转个人中心页",type:"info"}),setTimeout((function(){result.jumpUrl?window.location.href="/web/geek/recommend":window.location.href=window.location.host}),1e3);break;case 200143:$.dialog({title:"",content:'<div style="padding: 4px 0 30px;">服务器未获取到上传文件，请更换文件或稍后重试</div>',type:"error",closeText:!0,confirmText:"确定",cancelText:!1,preKa:"",wrapClass:"dialog-icons-default",lock:!0});break;case 200140:$.dialog({title:"",content:'<div style="padding: 4px 0 30px;">您上传的文件超过'.concat(this.maxSize,"M，请重新选择</div>"),type:"warning",closeText:!0,confirmText:"确定",cancelText:!1,preKa:"",wrapClass:"dialog-icons-default",lock:!0});break;case 200147:$.dialog({title:"",content:'<div style="padding: 4px 0 30px;">仅支持DOC、DOCX、PDF格式简历文件，请重新选择</div>',type:"warning",closeText:!0,confirmText:"确定",cancelText:!1,preKa:"",wrapClass:"dialog-icons-default",lock:!0});break;default:$.dialog({title:"",content:'<div style="padding: 4px 0 30px;">服务器异常，请稍后重试</div>',type:"error",closeText:!0,confirmText:"确定",cancelText:!1,preKa:"",wrapClass:"dialog-icons-default",lock:!0})}if(0!=e.code){this.$toast({type:"error",content:e.message}),this.showUploadDialog=!1;try{this.sendEvent("user_resume_upload_error")}catch(e){}}},previewImg:function(e){if(1===this.supportType)return this.uploadStatus="uploadSuccess",void this.watchPdfStatus();if(this.previewUrl){e&&(this.uploadStatus="uploadSuccess",this.previewErrorNum=0);var t=new Image,i="/wapi/zpgeek/resume/preview4geek/".concat(this.previewUrl);t.src=i;var s=this;t.onload=function(){s.uploadStatus="previewSuccess",s.imgSrc=i,(0,a.post)("/wapi/zpCommon/actionLog/previewSuccess.json",{previewUrl:this.previewUrl})},t.onerror=function(){s.previewErrorNum++,s.previewErrorNum<3?s.previewImg():s.uploadStatus="previewFail",(0,a.post)("/wapi/zpCommon/actionLog/previewFail.json",{previewUrl:this.previewUrl}),this.sendAction({action:"geek-resume-preview-fail",p:_PAGE.uid,p2:this.getFileType(this.fileInfo.name),p3:this.fileInfo.size,p4:this.isWorks?1:0})}}},checkFileType:function(){var e=this;(0,o._fileTypeCheck)({encryptUrl:this.previewUrl,annexType:1}).then((function(t){0==t.code&&(e.supportType=t.zpData.supportType,1==t.zpData.supportType?e.pdfSrc=encodeURIComponent("/wapi/zpgeek/resume/preview4geek/".concat(e.previewUrl,"?annexType=1")):e.previewImg())}))},confimAdd:function(){var e=this;this.savingData=!0,(0,a.post)("/wapi/zpgeek/resume/attachment/save.json?previewUrl=".concat(this.previewUrl,"&annexType=").concat(this.isWorks||1==this.$route.query.annexType?1:0)).then((function(t){0==t.code?(e.$emit("uploadResult","success"),e.showUploadDialog=!1,e.$toast({type:"success",content:"上传成功"}),e.jumpMiniscan(0)):e.isAnalysis||e.$toast({type:"error",content:t.message}),e.savingData=!1}))},jumpMiniscan:function(e){if("miniscan"==this.$route.query.from)if("prewLayerNotJump"===e&&1==this.step);else{var t=this.$route.fullPath,i=t.split("from=miniscan");"1"==this.$route.query.annexType&&(i=t.split("from=miniscan&annexType=1")),window.location.href=i.join("")}},watchPdfStatus:function(){var e=this;if(this.timer&&clearInterval(this.timer),this.pdfFrame||(this.pdfFrame=document.getElementById("pdfFrame").contentWindow,this.pdfFrame)){var t=0;this.timer=setInterval((function(){t+=500,e.pdfFrame.PDFView.downloadComplete?(clearInterval(e.timer),e.uploadStatus="previewSuccess"):t>=2e4&&(clearInterval(e.timer),e.uploadStatus="previewFail",e.sendAction({action:"geek-resume-preview-fail",p:_PAGE.uid,p2:e.getFileType(e.fileInfo.name),p3:e.fileInfo.size,p4:e.isWorks?1:0}))}),500)}}}},"mounted",(function(){})),n(s,"destroyed",(function(){this.timer&&clearInterval(this.timer)})),s);t.default=r},605:function(e,t,i){},799:function(e,t,i){"use strict";i.r(t);var s=i(934),a=i(603);for(var o in a)"default"!==o&&function(e){i.d(t,e,(function(){return a[e]}))}(o);i(810);var n=i(7),r=Object(n.a)(a.default,s.a,s.b,!1,null,null,null);t.default=r.exports},809:function(e,t,i){e.exports=i.p+"static/images/icon-resume-upload.5e23ce9d.png"},810:function(e,t,i){"use strict";var s=i(605);i.n(s).a},934:function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ui-dialog",{attrs:{wrapClass:e.classes,showFooter:!1,lock:1==e.step,preventLayer:1==e.step},on:{"on-visible-change":e.dialogChange,"on-confirm":e.confirmDialog,"on-cancel":e.jumpMiniscan,"on-close":e.jumpMiniscan,"on-layer":function(t){return e.jumpMiniscan("prewLayerNotJump")}},model:{value:e.showUploadDialog,callback:function(t){e.showUploadDialog=t},expression:"showUploadDialog"}},[s("template",{slot:"content"},[0==e.step?s("div",{staticClass:"upload-normal"},[e.formTitle?s("p",{staticStyle:{"font-weight":"400",margin:"0 5px 10px 5px","font-size":"1.17em"}},[e._v(e._s(e.formTitle))]):e._e(),s("p",[e._v(e._s(e.isWorks?"建议上传PDF文件，也支持DOC、DOCX、JPG、PNG格式文件":"支持DOC、DOCX、PDF、JPG、PNG格式附件"))]),s("p",{staticClass:"red"},[e._v("文件大小不超过"+e._s(e.maxSize)+"M")]),s("div",{staticClass:"btns"},[s("a",{staticClass:"btn btn-primary btn-file",attrs:{href:"javascript:;"}},[e._v(" "+e._s(e.isWorks?"上传作品集":"上传附件简历")+" "),s("input",{ref:"selectfile",attrs:{type:"file",name:"file",ka:"user-resume-upload-file",accept:"image/jpg, image/jpeg, image/png, application/vnd.ms-powerpoint, application/pdf, application/msword, application/vnd.openxmlformats-officedocument.wordprocessingml.document, application/vnd.openxmlformats-officedocument.presentationml.presentation"},on:{change:function(t){return e.handleFileChange(t)}}})])])]):s("div",{staticClass:"upload-preview"},[s("div",{staticClass:"preview-box"},[s("h3",{staticClass:"title"},[e._v("上传附件")]),s("div",{staticClass:"img-box"},[s("img",{directives:[{name:"show",rawName:"v-show",value:0===e.supportType&&"previewSuccess"==e.uploadStatus,expression:"supportType === 0 && uploadStatus == 'previewSuccess'"}],attrs:{src:e.imgSrc}}),s("iframe",{directives:[{name:"show",rawName:"v-show",value:1===e.supportType&&"previewSuccess"==e.uploadStatus,expression:"supportType === 1 && uploadStatus == 'previewSuccess'"}],staticStyle:{display:"block",width:"100%",height:"100%"},attrs:{id:"pdfFrame",src:"/web/common/pdfjs/web/viewer.html?file="+e.pdfSrc,frameborder:"0"}}),"previewSuccess"!=e.uploadStatus?s("div",{staticClass:"data-tips"},[s("div",{staticClass:"tip-inner"},[s("p",[s("img",{attrs:{src:i(809),alt:""}})]),"uploadIng"==e.uploadStatus?s("p",{staticClass:"gray"},[s("i",{staticClass:"ui-icon-loading"}),e._v("正在上传中 ")]):e._e(),"uploadSuccess"==e.uploadStatus?s("p",{staticClass:"gray"},[s("i",{staticClass:"ui-icon-loading"}),e._v("正在预览中 ")]):e._e(),"uploadFail"==e.uploadStatus?s("p",{staticClass:"gray"},[e._v("上传失败")]):e._e(),"uploadFail"==e.uploadStatus?s("p",{staticClass:"gray"},[e._v("请重新上传，如仍然无法成功，可尝试更改文件格式")]):e._e(),"previewFail"==e.uploadStatus?s("p",{staticClass:"gray"},[e._v("预览失败")]):e._e(),"previewFail"==e.uploadStatus?s("p",{staticClass:"gray"},[e._v(" 点击 "),s("a",{staticClass:"link-refresh text-blue",attrs:{href:"javascript:;",ka:"user-resume-refresh"},on:{click:function(t){return e.previewImg(!0)}}},[e._v("刷新")]),e._v(" 重新预览 ")]):e._e()])]):e._e()])]),s("div",{staticClass:"preview-sider"},["previewSuccess"==e.uploadStatus?s("h3",{staticClass:"title"},[e._v("附件确认")]):s("h3",{staticClass:"title"},[e._v("附件状态")]),e.fileInfo.name?s("p",[e._v("附件名称："+e._s(e.fileInfo.name))]):e._e(),e.fileInfo.size?s("p",[e._v("附件大小："+e._s(parseInt(e.fileInfo.size/1024))+" KB")]):e._e(),e.fileInfo.name?s("p",[e._v("附件格式："+e._s(e.getFileType(e.fileInfo.name)))]):e._e(),1!=e.supportType?s("p",{staticClass:"gray"},[e._v("附件内容只能预览10页，且有一定压缩，但不影响Boss看到内容的质量。")]):e._e(),s("p",{staticClass:"gray"},[e._v("Boss将你转发给同事时，可能会将附件简历一并转发。")]),"uploadFail"==e.uploadStatus||"previewSuccess"==e.uploadStatus||"previewFail"==e.uploadStatus?s("div",{staticClass:"btns"},[s("a",{staticClass:"btn btn-file btn-outline",attrs:{href:"javascript:;"}},[e._v(" 重新选择 "),s("input",{ref:"selectfile",attrs:{type:"file",name:"file",ka:"user_resume_add_reupload",accept:"image/jpg, image/jpeg, image/png, application/vnd.ms-powerpoint, application/pdf, application/msword, application/vnd.openxmlformats-officedocument.wordprocessingml.document, application/vnd.openxmlformats-officedocument.presentationml.presentation"},on:{change:e.handleFileChange}})]),"previewSuccess"==e.uploadStatus?s("button",{staticClass:"btn btn-primary btn-sure",class:{disabled:e.savingData},attrs:{type:"button",ka:"user_resume_add_sure"},on:{click:e.confimAdd}},[e.savingData?s("i",{staticClass:"ui-icon-loading"}):e._e(),e._v("确定添加 ")]):e._e()]):e._e()])])])],2)},a=[];i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return a}))}}]);